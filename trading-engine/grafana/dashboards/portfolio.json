{
  "dashboard": {
    "title": "Portfolio Dashboard",
    "tags": ["trading", "portfolio"],
    "timezone": "browser",
    "schemaVersion": 38,
    "version": 1,
    "refresh": "10s",
    "panels": [
      {
        "id": 1,
        "title": "Portfolio Value",
        "type": "stat",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
        "targets": [
          {
            "datasource": {"type": "postgres", "uid": "PostgreSQL"},
            "rawSql": "SELECT $__time(updated_at), total_value FROM portfolio_state WHERE id = 1 ORDER BY updated_at",
            "format": "time_series",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "currencyUSD",
            "decimals": 2
          }
        }
      },
      {
        "id": 2,
        "title": "Cash vs Deployed Capital",
        "type": "piechart",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
        "targets": [
          {
            "datasource": {"type": "postgres", "uid": "PostgreSQL"},
            "rawSql": "SELECT 'Cash' as label, cash as value FROM portfolio_state WHERE id = 1 UNION ALL SELECT 'Deployed' as label, deployed_capital as value FROM portfolio_state WHERE id = 1",
            "format": "table",
            "refId": "A"
          }
        ]
      },
      {
        "id": 3,
        "title": "Position Breakdown",
        "type": "table",
        "gridPos": {"h": 8, "w": 24, "x": 0, "y": 8},
        "targets": [
          {
            "datasource": {"type": "postgres", "uid": "PostgreSQL"},
            "rawSql": "SELECT symbol, quantity, avg_cost, current_price, current_value, sector FROM positions ORDER BY current_value DESC",
            "format": "table",
            "refId": "A"
          }
        ]
      },
      {
        "id": 4,
        "title": "Sector Allocation",
        "type": "barchart",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 16},
        "targets": [
          {
            "datasource": {"type": "postgres", "uid": "PostgreSQL"},
            "rawSql": "SELECT sector, SUM(current_value) as total_value FROM positions WHERE sector IS NOT NULL GROUP BY sector ORDER BY total_value DESC",
            "format": "table",
            "refId": "A"
          }
        ]
      }
    ]
  }
}

